# Предсказание Риска Сердечного Приступа

Проект предназначен для предсказания вероятности сердечного приступа на основе медицинских данных. Решение построено с использованием **Python**, **Scikit-learn**, **FastAPI**, и других библиотек машинного обучения. Предоставляется REST API для получения предсказаний по JSON и CSV.

---

## Структура проекта

```
project/
├── app/                    # Основная логика приложения
│   ├── model_trainer/      # Обучение моделей, сохранение, метрики
│   │   ├── evaluator.py    # класс ModelEvaluator
│   │   ├── pipelines.py    # получить пайплайн по модели
│   │   ├── save_load.py    # save_model(), load_model() и пр.
│   │   └── trainer.py      # класс ModelTrainer
│   ├── services/           # для FastAPI
│   │   └── prediction.py
│   ├── __init__.py         # Пакет app              
│   ├── api.py              # Обработка запросов
│   ├── config.py           # Конфигурации (пути, имена колонок и т.д.)
│   ├── data_loader.py      # Загрузка данных
│   ├── main.py             # Точка входа для FastAPI
│   ├── preprocessing.py    # Функции предобработки и валидации
│   ├── schemas.py          # Схемы данных
│   └── validators.py       # Валидаторы
│
├── notebooks/
│   ├── experiments.ipynb
│   └── 01_eda_and_model.ipynb   # Исследование данных и анализ
│
├── models/                # Сохранённые модели, пороги, метрики и т.д.
│       └── 
├── data/                  # Данные для обучения и тестирования
│       └── 
├── results/               # Результаты обучения
│       └── 
├── train.py               # Обучение и сохранение моделей, метрики и порога 
├── requirements.txt       # Зависимости проекта
└── README.md              # Этот файл
```

---

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск FastAPI сервера

```bash
uvicorn main:app --reload
```

Сервер будет доступен по адресу:
[http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) – Swagger UI

---

## Обучение моделей

Модели обучаются **вне веб-приложения**, в train.py. Подробнее в:

```bash
python train.py
```

Все этапы (EDA, обучение, кросс-валидация, подбор порога, сохранение артефактов) выполняются через импорт модулей `app/`.

---

## REST API

### `/predict_json`

**Метод:** `POST`
**Описание:** Получение предсказаний по JSON-массиву
**Пример запроса:**

```json
[
  {
    "Age": 0.6292134831460674,
    "Cholesterol": 0.0928571428571429,
    "Heart rate": 0.0641613198900091,
    ...
  }
]
```

**Ответ:**

```json
[
  {
    "id": 6632,
    "prediction": 1,
    "probability": 0.375
  }
]
```

---

### `/predict_file`

**Метод:** `POST`
**Описание:** Загрузка CSV-файла и получение предсказаний
**Ответ:**

```json
{
  "predictions": [
    {
      "id": 101,
      "prediction": 0
    },
    ...
  ]
}
```

---

## Используемые технологии

* Python 3.12+
* pandas, numpy, scikit-learn
* FastAPI
* joblib (сериализация)
* matplotlib / seaborn (в ноутбуках)
* Jupyter Notebook (только для исследований)

---

## Метрики

После обучения сохраняются метрики модели в `models/metrics.json`:

* F1-score
* Precision
* Recall
* ROC-AUC
* Матрица ошибок
* Лучший порог
* Лучшие гиперпараметры

---

## Принцип разделения

* Исследования и эксперименты выполняются **только в ноутбуках**
* Все функции, модели и пайплайны — **вынесены в модули**
* Приложение (FastAPI) не содержит кода обучения

---

## Автор

**Шакиров В.Р.** — специалист в области Data Science и Python.
